var oe=Object.defineProperty,se=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var z=(t,a,r)=>a in t?oe(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,v=(t,a)=>{for(var r in a||(a={}))B.call(a,r)&&z(t,r,a[r]);if(R)for(var r of R(a))H.call(a,r)&&z(t,r,a[r]);return t},b=(t,a)=>se(t,le(a));var k=(t,a)=>{var r={};for(var o in t)B.call(t,o)&&a.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&R)for(var o of R(t))a.indexOf(o)<0&&H.call(t,o)&&(r[o]=t[o]);return r};import{r as w,R as e,k as ce,L as G,S as ie,e as F,g as me}from"./vendor.64e57edd.js";import{s as pe,bs as ue,G as de,bt as Ee,J as he,v as fe,t as ge,u as j,h as S,f as D,C as V,bu as ve,ah as be,bv as M,H as L,bw as u,bx as _,by as ye,a as T,aY as we,T as A,B as $,aS as xe,P as Se,Q as Ce,bz as Re,bA as ke,bB as q,bC as je,V as Y,g as Te,ae as Ae,af as Oe,bD as Fe,U as P,aQ as De}from"./index.7fe6cc41.js";import{F as Q,a as K,b as y}from"./formik.178388d5.js";import{T as J}from"./react-textarea-autosize.b1a14e4d.js";import{C as W}from"./Card.69bf34f3.js";import{T as Le}from"./types.401d8b7f.js";import{H as Pe,c as We}from"./contants.49de9412.js";import{u as O,A as I}from"./use-toast.57c096e4.js";import{S as Ie,a as Ue}from"./SelectTrigger.1fb95794.js";import{S as Ne,a as Be,b as He}from"./SelectWrapper.3debf5b8.js";import{I as U}from"./image.3e83825b.js";import"./prop-types.d6ec705b.js";import"./react-redux.d0311eef.js";import"./axios.7b768d2b.js";import"./focus-visible.85b77dad.js";function N(){return N=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},N.apply(this,arguments)}function ze(t,a){if(t==null)return{};var r={},o=Object.keys(t),m,s;for(s=0;s<o.length;s++)m=o[s],!(a.indexOf(m)>=0)&&(r[m]=t[m]);return r}var X=pe((t,a)=>{var r=ue("Textarea",t),o=de(t),{className:m,rows:s}=o,n=ze(o,["className","rows"]),l=Ee(n),c=["h","minH","height","minHeight"],i=s?he(r,c):r;return w.exports.createElement(fe.textarea,N({ref:a,rows:s},l,{className:ge("chakra-textarea",m),__css:i}))});const Ge=()=>{const t=Object.values(Le),{addingDealerCar:a}=j(n=>n.carsReducer),{catalogQuery:r}=j(n=>n.globalAppState),o=S(),m=O(),s={manufacturer:"",modelGroup:"",modelDetail:"",bodyStyle:"",damage:"",location:"",odometer:0,cylinders:0,drive:"",engine:0,transmission:"",year:"",keys:"",fuelType:"",color:"",price:0,description:"",photos:null};return e.createElement(D,{pt:["32px",null,null,"40px"]},e.createElement(V,null,e.createElement(W,{w:"500px",bg:"#fff",p:"4"},e.createElement(Q,{initialValues:s,onSubmit:(n,{setFieldError:l})=>{const h=n,{photos:c,keys:i}=h,E=k(h,["photos","keys"]),f=new FormData;for(let g in E)f.append(g,n[g]);if(c)for(let g of c)f.append("photo[]",g);i&&f.append("keys",Pe.YES);const p=new URLSearchParams(r);o(ve(f)).unwrap().then(()=>{o(be(p)),m({title:"New car edded successfully",position:"top",status:"success",duration:1500})}).catch(g=>{let C="";M(g)&&g.status===422&&(C="Fill in required fields",l("manufacturer","required")),m({title:C,position:"top",variant:"solid",status:"error",duration:2e3})})}},({values:n,setFieldValue:l})=>e.createElement(K,null,e.createElement(L,null,"Add Car"),e.createElement(u,{name:"manufacturer",placeholder:"Manufacturer"}),e.createElement(u,{name:"modelGroup",placeholder:"Model group"}),e.createElement(u,{name:"modelDetail",placeholder:"Model detail"}),e.createElement(u,{name:"bodyStyle",placeholder:"Body style"}),e.createElement(u,{name:"damage",placeholder:"damage"}),e.createElement(u,{name:"location",placeholder:"location"}),e.createElement(u,{name:"odometer",placeholder:"odometer",type:"number",value:n.odometer||""}),e.createElement(u,{name:"cylinders",placeholder:"cylinders",type:"number",value:n.cylinders||""}),e.createElement(u,{name:"drive",placeholder:"drive"}),e.createElement(u,{name:"engine",type:"number",value:n.engine||"",placeholder:"Engine capacity"}),e.createElement(y,{name:"transmission"},({field:c})=>e.createElement(_,{pt:"2"},e.createElement(ye,b(v({},c),{bg:"#EAEAEB",opacity:"0.5",placeholder:"Transmission"}),t.map(i=>e.createElement("option",{key:i,value:i},i))))),e.createElement(u,{name:"year",placeholder:"Year",type:"number",value:n.year||""}),e.createElement(u,{name:"fuelType",placeholder:"Fuel type"}),e.createElement(u,{name:"color",placeholder:"Color"}),e.createElement(u,{name:"price",placeholder:"Price",type:"number",value:n.price||""}),e.createElement(y,{name:"keys"},({field:c})=>e.createElement(_,{pt:"2"},e.createElement(T,null,e.createElement(we,v({colorScheme:"autoOrange",name:"kes"},c)),e.createElement(A,null,"Has keys")))),e.createElement(y,{name:"description"},({field:c})=>e.createElement(X,b(v({mt:"2"},c),{placeholder:"Write Description",size:"sm",as:J,maxRows:10}))),e.createElement(y,{name:"photos"},({field:c})=>e.createElement("input",b(v({type:"file"},c),{multiple:!0,value:void 0,onChange:i=>{const E=i.currentTarget.files;l("photos",E)}}))),e.createElement($,{type:"submit",mt:"4",mb:"4",isLoading:a},"Add"))))))},Ve=o=>{var m=o,{onSelect:t,name:a}=m,r=k(m,["onSelect","name"]);const{isOpen:s,onToggle:n,onOpen:l,onClose:c}=xe(),[i,E]=w.exports.useState(),[f,p]=w.exports.useState(""),[h,g]=w.exports.useState(""),[C,Z]=w.exports.useState([]),ee=S(),te=O(),ae=()=>{p(i?i.name:"Search for user...")},re=d=>{ee(Re(d)).unwrap().then(x=>{Z(x)}).catch(()=>te({title:"Could not fetch users",position:"top",status:"error",duration:2e3}))},ne=C.filter(d=>d.name.toLocaleLowerCase().includes(h.toLocaleLowerCase()));return e.createElement(Ne,v({areOptionsOpen:s},r),e.createElement(Se,{onClick:c,isActive:s}),e.createElement(Be,null,e.createElement(Ie,{areOptionsOpen:s,areOptionsSelected:!!i,clearCb:()=>{E(void 0)}},e.createElement(Ue,{autoComplete:"off",bg:"autoGrey.200",name:a||"",label:"Search for user...",placeholder:f,value:i?We(i.name):h,onChange:d=>{const x=d.currentTarget.value;re(x),g(x),E(void 0),x&&l()},onFocus:()=>{ae()}})),e.createElement(He,{isOpen:s},ne.map(d=>e.createElement(Ce,{h:"80px",onClick:()=>{p(d.name),n(),t(d.id),E(d)},key:d.id},e.createElement(T,{w:"full"},e.createElement(I,{ratio:1/1,w:"50px"},e.createElement(U,{w:"full",h:"full",src:d.avatar,fallbackSrc:"https://image.shutterstock.com/image-vector/profile-picture-avatar-icon-vector-260nw-1760295569.jpg",borderRadius:"100px"})),e.createElement(L,null,d.name)))))))},Me=({})=>{const t=S(),a=O(),{addingReview:r}=j(n=>n.customers),o={text:"",userId:"",photos:null},m=n=>{let l="";return n?n.length!==24&&(l="Invalid length"):l="Required",l},s=n=>{let l="";return n&&n.length>4&&(l="Photos must be less then 4"),l};return e.createElement(Q,{initialValues:o,onSubmit:(n,{setErrors:l})=>{const f=n,{photos:c}=f,i=k(f,["photos"]),E=new FormData;if(c)for(let p of c)E.append("photo[]",p);for(let[p,h]of Object.entries(i))E.append(p,h);t(ke(E)).unwrap().then(()=>{t(q("")),a({title:"New Review added",duration:2e3,status:"success",position:"top"})}).catch(p=>{var h;M(p)&&p.status===422&&((h=p.errors)==null?void 0:h.length)&&l(je(p.errors))})}},({setFieldValue:n})=>e.createElement(K,null,e.createElement(L,{pb:"4"},"Add new Review"),e.createElement(y,{name:"userId",validate:m},({field:l,form:c})=>e.createElement(e.Fragment,null,e.createElement(Ve,b(v({},l),{name:"userId",onSelect:i=>{n("userId",i)}})),e.createElement(A,{as:"span",color:"red"},c.errors.userId))),e.createElement(y,{name:"text"},({field:l})=>e.createElement(X,b(v({mt:"2"},l),{placeholder:"Write Description",size:"sm",as:J,maxRows:10}))),e.createElement(y,{name:"photos",validate:s},({field:l,form:c})=>e.createElement(e.Fragment,null,e.createElement("input",b(v({},l),{type:"file",multiple:!0,value:void 0,onChange:i=>{n("photos",i.currentTarget.files)}})),e.createElement(A,{as:"span",display:"block",color:"red"},c.errors.photos))),e.createElement($,{type:"submit",mt:"4",isLoading:r},"Add Review")))},_e=({})=>{const{reviews:t,removingReview:a,fetchingReviews:r}=j(s=>s.customers),o=S(),m=O();return w.exports.useEffect(()=>{o(q(""))},[]),e.createElement(D,{pt:["32px",null,null,"40px"]},e.createElement(V,null,e.createElement(Y,{spacing:"32px"},e.createElement(W,{maxW:"500px",p:"4"},e.createElement(Me,null)),e.createElement(W,{w:"full",maxW:"500px"},e.createElement(Y,{w:"full"},r?e.createElement(e.Fragment,null,"Getting Reviews...",e.createElement(Te,null)):t.length?t.map((s,n)=>e.createElement(T,{key:n,bg:"autoGrey.200",w:"full",p:"4",borderRadius:"8",opacity:a?"0.5":"1"},e.createElement(Ae,{icon:e.createElement(Oe,null),"aria-label":"remove review",isLoading:a,onClick:()=>{o(Fe(s.id)).then(()=>m({title:"Review Deleted",status:"success",duration:2e3,position:"top"})).catch(()=>m({title:"Could not delete the review, contact to the developer",status:"error",duration:2e3,position:"top"}))}}),e.createElement(I,{ratio:1/1,minW:"80px"},e.createElement(U,{src:s.user&&s.user.avatar,fallbackSrc:"https://image.shutterstock.com/image-vector/profile-picture-avatar-icon-vector-260nw-1760295569.jpg",borderRadius:"100px"})),e.createElement(A,{overflowWrap:"anywhere"},s.text),s.photos&&s.photos.map(l=>e.createElement(I,{key:l,ratio:1/1,minW:"60px"},e.createElement(U,{src:l}))))):e.createElement(e.Fragment,null,"No Review Yet"))))))},ct=()=>{const{path:t}=ce(),a=S();return e.createElement(D,null,e.createElement(T,{w:"full",justify:"center",pt:"4"},e.createElement(P,{border:"1px solid"},e.createElement(G,{to:`${t}/add-car`},"add new car")),e.createElement(P,{border:"1px solid"},e.createElement(G,{to:`${t}/add-review`},"add new Review")),e.createElement(P,{color:"red",border:"1px solid",onClick:()=>a(De())},"logout")),e.createElement(ie,null,e.createElement(F,{path:t,exact:!0},e.createElement(me,{to:`${t}/add-review`})),e.createElement(F,{path:`${t}/add-car`,render:()=>e.createElement(Ge,null),exact:!0}),e.createElement(F,{path:`${t}/add-review`,render:()=>e.createElement(_e,null),exact:!0})))};export{ct as AdminPage,ct as default};
