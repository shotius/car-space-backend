var Ee=Object.defineProperty,he=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var X=(t,l,a)=>l in t?Ee(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,v=(t,l)=>{for(var a in l||(l={}))K.call(l,a)&&X(t,a,l[a]);if(F)for(var a of F(l))J.call(l,a)&&X(t,a,l[a]);return t},x=(t,l)=>he(t,fe(l));var D=(t,l)=>{var a={};for(var n in t)K.call(t,n)&&l.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&F)for(var n of F(t))l.indexOf(n)<0&&J.call(t,n)&&(a[n]=t[n]);return a};import{r as b,R as e,k as ge,L as M,S as ye,f as L,e as be}from"./vendor.576a7237.js";import{P as ve,bu as xe,a0 as we,aJ as Ce,a1 as Se,R as ke,Q as Oe,g as I,u as C,a as k,C as P,e as z,b5 as Ae,bv as Re,ah as je,b as Z,n as O,F as d,bw as H,H as U,a_ as Te,T as W,B as V,aW as Ne,h as Fe,a8 as De,bx as Le,by as Ie,bz as ee,bA as Pe,V as T,w as te,I as ae,af as re,bB as Ue,bC as We,bD as Be,A,aP as Me,aO as ze,aQ as He,k as Ve,br as $e,m as Ge,aT as _e,bE as qe,aU as Ye,aR as Qe}from"./index.38124d94.js";import{S as Ke,a as Je,C as $}from"./SelectTrigger.b70c0b15.js";import{F as G,a as _,b as w}from"./formik.30c45d87.js";import{T as le}from"./react-textarea-autosize.f1892001.js";import{C as N}from"./Card.7d4ae326.js";import{T as Xe}from"./types.401d8b7f.js";import{S as ne}from"./select.aa888b63.js";import{c as Ze}from"./TextSecondary.11750561.js";import{S as et,a as tt,b as at}from"./SelectWrapper.ecebd7a2.js";import{A as q}from"./aspect-ratio.73a99b93.js";import{I as Y}from"./image.44631398.js";import{d as rt,O as lt}from"./OrderListCard.ec182cc1.js";import"./prop-types.d6ec705b.js";import"./react-redux.0b249e8a.js";import"./axios.7b768d2b.js";import"./yup.df40d5b6.js";import"./focus-visible.c4e3ef79.js";import"./NotSpecified.74fd68fb.js";function Q(){return Q=Object.assign||function(t){for(var l=1;l<arguments.length;l++){var a=arguments[l];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},Q.apply(this,arguments)}function nt(t,l){if(t==null)return{};var a={},n=Object.keys(t),i,c;for(c=0;c<n.length;c++)i=n[c],!(l.indexOf(i)>=0)&&(a[i]=t[i]);return a}var oe=ve((t,l)=>{var a=xe("Textarea",t),n=we(t),{className:i,rows:c}=n,r=nt(n,["className","rows"]),o=Ce(r),s=["h","minH","height","minHeight"],m=c?Se(a,s):a;return b.exports.createElement(ke.textarea,Q({ref:l,rows:c},o,{className:Oe("chakra-textarea",i),__css:m}))});const ot=()=>{const t=Object.values(Xe),{addingDealerCar:l}=I(r=>r.carsReducer),{catalogQuery:a}=I(r=>r.globalAppState),n=C(),i=k(),c={manufacturer:"",modelGroup:"",modelDetail:"",bodyStyle:"",damage:"",location:"",odometer:0,cylinders:0,drive:"",engine:0,transmission:"",year:"",keys:"",fuelType:"",color:"",price:0,description:"",photos:null};return e.createElement(P,{pt:["32px",null,null,"40px"]},e.createElement(z,null,e.createElement(N,{w:"500px",bg:"#fff",p:"4"},e.createElement(G,{initialValues:c,onSubmit:(r,{setFieldError:o})=>{const E=r,{photos:s,keys:m}=E,p=D(E,["photos","keys"]),f=new FormData;for(let h in p)f.append(h,r[h]);if(s)for(let h of s)f.append("photo[]",h);m&&f.append("keys",Ae.YES);const u=new URLSearchParams(a);n(Re(f)).unwrap().then(()=>{n(je(u)),i({title:"New car edded successfully",position:"top",status:"success",duration:1500})}).catch(h=>{let S="";Z(h)&&h.status===422&&(S="Fill in required fields",o("manufacturer","required")),i({title:S,position:"top",variant:"solid",status:"error",duration:2e3})})}},({values:r,setFieldValue:o})=>e.createElement(_,null,e.createElement(O,null,"Add Car"),e.createElement(d,{name:"manufacturer",placeholder:"Manufacturer"}),e.createElement(d,{name:"modelGroup",placeholder:"Model group"}),e.createElement(d,{name:"modelDetail",placeholder:"Model detail"}),e.createElement(d,{name:"bodyStyle",placeholder:"Body style"}),e.createElement(d,{name:"damage",placeholder:"damage"}),e.createElement(d,{name:"location",placeholder:"location"}),e.createElement(d,{name:"odometer",placeholder:"odometer",type:"number",value:r.odometer||""}),e.createElement(d,{name:"cylinders",placeholder:"cylinders",type:"number",value:r.cylinders||""}),e.createElement(d,{name:"drive",placeholder:"drive"}),e.createElement(d,{name:"engine",type:"number",value:r.engine||"",placeholder:"Engine capacity"}),e.createElement(w,{name:"transmission"},({field:s})=>e.createElement(H,{pt:"2"},e.createElement(ne,x(v({},s),{bg:"#EAEAEB",opacity:"0.5",placeholder:"Transmission"}),t.map(m=>e.createElement("option",{key:m,value:m},m))))),e.createElement(d,{name:"year",placeholder:"Year",type:"number",value:r.year||""}),e.createElement(d,{name:"fuelType",placeholder:"Fuel type"}),e.createElement(d,{name:"color",placeholder:"Color"}),e.createElement(d,{name:"price",placeholder:"Price",type:"number",value:r.price||""}),e.createElement(w,{name:"keys"},({field:s})=>e.createElement(H,{pt:"2"},e.createElement(U,null,e.createElement(Te,v({colorScheme:"autoOrange",name:"kes"},s)),e.createElement(W,null,"Has keys")))),e.createElement(w,{name:"description"},({field:s})=>e.createElement(oe,x(v({mt:"2"},s),{placeholder:"Write Description",size:"sm",as:le,maxRows:10}))),e.createElement(w,{name:"photos"},({field:s})=>e.createElement("input",x(v({type:"file"},s),{multiple:!0,value:void 0,onChange:m=>{const p=m.currentTarget.files;o("photos",p)}}))),e.createElement(V,{type:"submit",mt:"4",mb:"4",isLoading:l},"Add"))))))},se=i=>{var c=i,{onSelect:t,name:l,onUserSelect:a}=c,n=D(c,["onSelect","name","onUserSelect"]);const{isOpen:r,onToggle:o,onOpen:s,onClose:m}=Ne(),[p,f]=b.exports.useState(),[u,E]=b.exports.useState(""),[h,S]=b.exports.useState(""),[g,R]=b.exports.useState([]),[ce,B]=b.exports.useState(!1),ie=C(),me=k(),de=()=>{E(p?p.fullName:"Search for user...")},pe=y=>{B(!0),ie(Le(y)).unwrap().then(j=>{R(j),B(!1)}).catch(()=>{me({title:"Could not fetch users",position:"top",status:"error",duration:2e3}),B(!1)})},ue=g.filter(y=>y.fullName.toLocaleLowerCase().includes(h.toLocaleLowerCase()));return e.createElement(et,v({areOptionsOpen:r},n),e.createElement(Fe,{onClick:m,isActive:r}),e.createElement(tt,null,e.createElement(Ke,{areOptionsOpen:r,areOptionsSelected:!!p,clearCb:()=>{f(void 0)}},e.createElement(Je,{autoComplete:"off",bg:"autoGrey.200",name:l||"",label:"Search for user...",placeholder:u,value:p?Ze(p.fullName):h,onChange:y=>{const j=y.currentTarget.value;pe(j),S(j),f(void 0),j&&s()},onFocus:()=>{de()}})),e.createElement(at,{isOpen:r},ce?e.createElement(O,{textAlign:"center",w:"full"},"Fetching ..."," "):ue.map(y=>e.createElement(De,{h:"80px",onClick:()=>{E(y.fullName),o(),t(y.id),a&&a(y),f(y)},key:y.id},e.createElement(U,{w:"full"},e.createElement(q,{ratio:1/1,w:"50px"},e.createElement(Y,{w:"full",h:"full",src:y.avatar,fallbackSrc:"https://image.shutterstock.com/image-vector/profile-picture-avatar-icon-vector-260nw-1760295569.jpg",borderRadius:"100px"})),e.createElement(O,null,y.fullName)))))))},st=({})=>{const t=C(),l=k(),{addingReview:a}=I(r=>r.customers),n={text:"",userId:"",photos:null},i=r=>{let o="";return r?r.length!==24&&(o="Invalid length"):o="Required",o},c=r=>{let o="";return r&&r.length>4&&(o="Photos must be less then 4"),o};return e.createElement(G,{initialValues:n,onSubmit:(r,{setErrors:o})=>{const f=r,{photos:s}=f,m=D(f,["photos"]),p=new FormData;if(s)for(let u of s)p.append("photo[]",u);for(let[u,E]of Object.entries(m))p.append(u,E);t(Ie(p)).unwrap().then(()=>{t(ee("")),l({title:"New Review added",duration:2e3,status:"success",position:"top"})}).catch(u=>{var E;Z(u)&&u.status===422&&((E=u.errors)==null?void 0:E.length)&&o(Pe(u.errors))})}},({setFieldValue:r})=>e.createElement(_,null,e.createElement(O,{pb:"4"},"Add new Review"),e.createElement(w,{name:"userId",validate:i},({field:o,form:s})=>e.createElement(e.Fragment,null,e.createElement(se,x(v({},o),{name:"userId",onItemSelect:m=>{r("userId",m)}})),e.createElement(W,{as:"span",color:"red"},s.errors.userId))),e.createElement(w,{name:"text"},({field:o})=>e.createElement(oe,x(v({mt:"2"},o),{placeholder:"Write Description",size:"sm",as:le,maxRows:10}))),e.createElement(w,{name:"photos",validate:c},({field:o,form:s})=>e.createElement(e.Fragment,null,e.createElement("input",x(v({},o),{type:"file",multiple:!0,value:void 0,onChange:m=>{r("photos",m.currentTarget.files)}})),e.createElement(W,{as:"span",display:"block",color:"red"},s.errors.photos))),e.createElement(V,{type:"submit",mt:"4",isLoading:a},"Add Review")))},ct=({})=>{const{reviews:t,removingReview:l,fetchingReviews:a}=I(c=>c.customers),n=C(),i=k();return b.exports.useEffect(()=>{n(ee(""))},[]),e.createElement(P,{pt:["32px",null,null,"40px"]},e.createElement(z,null,e.createElement(T,{spacing:"32px"},e.createElement(N,{maxW:"500px",p:"4"},e.createElement(st,null)),e.createElement(N,{w:"full",maxW:"500px"},e.createElement(T,{w:"full"},a?e.createElement(e.Fragment,null,"Getting Reviews...",e.createElement(te,null)):t.length?t.map((c,r)=>e.createElement(U,{key:r,bg:"autoGrey.200",w:"full",p:"4",borderRadius:"8",opacity:l?"0.5":"1"},e.createElement(ae,{icon:e.createElement(re,null),"aria-label":"remove review",isLoading:l,onClick:()=>{n(Ue(c.id)).then(()=>i({title:"Review Deleted",status:"success",duration:2e3,position:"top"})).catch(()=>i({title:"Could not delete the review, contact to the developer",status:"error",duration:2e3,position:"top"}))}}),e.createElement(q,{ratio:1/1,minW:"80px"},e.createElement(Y,{src:c.user&&c.user.avatar,fallbackSrc:"https://image.shutterstock.com/image-vector/profile-picture-avatar-icon-vector-260nw-1760295569.jpg",borderRadius:"100px"})),e.createElement(W,{overflowWrap:"anywhere"},c.text),c.photos&&c.photos.map(o=>e.createElement(q,{key:o,ratio:1/1,minW:"60px"},e.createElement(Y,{src:o}))))):e.createElement(e.Fragment,null,"No Review Yet"))))))},it=({operation:t,userId:l,car:a,closeDrawer:n})=>{const i=C(),c=k();let r;return a&&t==="modifying"?r={carName:a.carName,deliveryAt:a.deliveryAt?rt(a.deliveryAt.toString(),"-"):new Date,location:a.location,price:a.price,status:a.status}:r={carName:"",deliveryAt:new Date,location:"",price:0,status:""},e.createElement(G,{initialValues:r,onSubmit:(o,{setSubmitting:s})=>{t==="modifying"&&a?i(We({carId:a.id,props:x(v({},o),{userId:l})})).unwrap().then(()=>{s(!1),n()}).catch(m=>{s(!1),c({title:m,status:"error",position:"top"}),n()}):i(Be(x(v({},o),{userId:l}))).unwrap().then(()=>{s(!1),n()}).catch(m=>{c({title:m,status:"error",position:"top"}),s(!1),n()})}},({isSubmitting:o})=>e.createElement(_,null,e.createElement(d,{name:"carName",placeholder:"car name"}),e.createElement(d,{name:"location",placeholder:"Location"}),e.createElement(d,{name:"price",placeholder:"Price",type:"number"}),e.createElement(w,{name:"status"},({field:s})=>e.createElement(H,{pt:"2"},e.createElement(ne,x(v({},s),{bg:"#EAEAEB",opacity:"0.5",placeholder:"Status"}),e.createElement("option",{value:"Completed"},"Completed"),e.createElement("option",{value:"On The Way"},"On the way")))),e.createElement(d,{name:"deliveryAt",bg:"#EAEAEB",opacity:"0.5",placeholder:"Status",type:"date",label:"Delivery at:  dd/mm/yyyy"}),e.createElement(V,{mt:"4",type:"submit",isLoading:o},t==="modifying"?"Update car":"Add Car")))},mt=({})=>{const[t,l]=b.exports.useState([]),[a,n]=b.exports.useState(!1),[i,c]=b.exports.useState(),[r,o]=b.exports.useState(!1),[s,m]=b.exports.useState("adding"),[p,f]=b.exports.useState(),u=k(),E=C();function h(g){n(!0),E(_e(g)).unwrap().then(R=>{l(R),n(!1)}).catch(()=>n(!1))}function S(g){E(qe(g)).unwrap().then(()=>{i&&h(i.id)}).catch(R=>u({title:R,position:"top",status:"error"}))}return e.createElement(P,{pt:["32px",null,null,"40px"]},e.createElement(z,null,e.createElement(N,{w:"full",maxW:"650px",p:"32px"},e.createElement(T,null,e.createElement(O,{textAlign:"center",fontSize:"24px"},"Add or Change Order"),e.createElement(se,{onSelect:()=>{},onUserSelect:g=>{h(g.id),c(g)}}),e.createElement(T,{pt:"4",w:"full"},i&&e.createElement(A,{mb:"2",onClick:()=>{o(!0),m("adding")}},"+ add new Car for ",i.fullName),a?e.createElement(te,null):t.length?t.map(g=>e.createElement(N,{w:"full",key:g.id,boxShadow:"0px 0px 10px lightgrey"},e.createElement(T,null,e.createElement(U,{w:"full",justify:"space-between"},e.createElement(A,{variant:"ghost",color:"autoOrange.500",onClick:()=>{o(!0),m("modifying"),f(g)}},"Modify order"),e.createElement(ae,{onClick:()=>S(g.id),icon:e.createElement(re,null),"aria-label":"delete order"})),e.createElement(lt,{order:g})))):e.createElement(O,{w:"full",textAlign:"center",pt:"4"},"No Ordered Cars"))),e.createElement(Me,{isOpen:r,placement:"right",onClose:()=>{o(!1)},size:"md"},e.createElement(ze,null),e.createElement(He,null,e.createElement(Ve,null),e.createElement($e,null,"Change/Add a Car"),e.createElement(Ge,null,e.createElement(it,{operation:s,userId:i?i.id:"",car:p,closeDrawer:()=>{o(!1),i&&h(i.id)}})))))))},Nt=()=>{const{path:t}=ge(),l=C();return e.createElement(P,null,e.createElement(Ye,{w:"full",justify:"center",pt:"4",direction:["column",null,"row"],align:"center"},e.createElement(A,{variant:"link"},e.createElement(M,{to:`${t}/add-car`,style:{color:"black"}},"add new car")),e.createElement($,{height:"20px",borderColor:"black",display:["none",null,"block"]}),e.createElement(A,{variant:"link"},e.createElement(M,{style:{color:"black"},to:`${t}/add-review`},"add new Review")),e.createElement($,{height:"20px",borderColor:"black",display:["none",null,"block"]}),e.createElement(A,{variant:"link"},e.createElement(M,{style:{color:"black"},to:`${t}/add-order`},"Add/change Ordered Car")),e.createElement($,{height:"20px",borderColor:"black",display:["none",null,"block"]}),e.createElement(A,{color:"red",border:"1px solid",onClick:()=>l(Qe())},"logout")),e.createElement(ye,null,e.createElement(L,{path:t,exact:!0},e.createElement(be,{to:`${t}/add-review`})),e.createElement(L,{path:`${t}/add-car`,render:()=>e.createElement(ot,null),exact:!0}),e.createElement(L,{path:`${t}/add-review`,render:()=>e.createElement(ct,null),exact:!0}),e.createElement(L,{path:`${t}/add-order`,render:()=>e.createElement(mt,null),exact:!0})))};export{Nt as AdminPage,Nt as default};
