var ne=Object.defineProperty,le=Object.defineProperties;var se=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var z=(t,a,r)=>a in t?ne(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,v=(t,a)=>{for(var r in a||(a={}))B.call(a,r)&&z(t,r,a[r]);if(R)for(var r of R(a))H.call(a,r)&&z(t,r,a[r]);return t},y=(t,a)=>le(t,se(a));var k=(t,a)=>{var r={};for(var n in t)B.call(t,n)&&a.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&R)for(var n of R(t))a.indexOf(n)<0&&H.call(t,n)&&(r[n]=t[n]);return r};import{r as w,R as e,k as ce,L as G,S as ie,e as F,g as me}from"./vendor.64e57edd.js";import{s as pe,bn as de,G as ue,ay as Ee,J as he,v as fe,t as ge,u as j,h as S,Z as T,f as N,C as V,a_ as ve,bo as ye,a5 as be,bp as _,H as L,bq as d,br as q,a as A,aT as we,T as O,B as M,aN as xe,Q as Se,R as Ce,bs as Re,bt as ke,bu as $,bv as je,V as Y,g as Te,a2 as Ae,a3 as Oe,bw as Fe,U as D,aL as Ne}from"./index.136f45ba.js";import{F as K,a as Q,b}from"./formik.178388d5.js";import{T as J}from"./react-textarea-autosize.b1a14e4d.js";import{C as P}from"./Card.d8090a88.js";import{T as Le}from"./types.401d8b7f.js";import{S as De}from"./select.475bd099.js";import{c as Pe}from"./capitalizeEach.6ec19d92.js";import{S as We,a as Ie}from"./SelectTrigger.f6e939ca.js";import{S as Ue,a as Be,b as He}from"./SelectWrapper.9f67e227.js";import{A as W}from"./aspect-ratio.6101d07e.js";import{I}from"./image.ed7d5a56.js";import"./prop-types.d6ec705b.js";import"./react-redux.d0311eef.js";import"./axios.7b768d2b.js";import"./yup.5af68d69.js";import"./focus-visible.85b77dad.js";function U(){return U=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},U.apply(this,arguments)}function ze(t,a){if(t==null)return{};var r={},n=Object.keys(t),m,l;for(l=0;l<n.length;l++)m=n[l],!(a.indexOf(m)>=0)&&(r[m]=t[m]);return r}var Z=pe((t,a)=>{var r=de("Textarea",t),n=ue(t),{className:m,rows:l}=n,o=ze(n,["className","rows"]),s=Ee(o),c=["h","minH","height","minHeight"],i=l?he(r,c):r;return w.exports.createElement(fe.textarea,U({ref:a,rows:l},s,{className:ge("chakra-textarea",m),__css:i}))});const Ge=()=>{const t=Object.values(Le),{addingDealerCar:a}=j(o=>o.carsReducer),{catalogQuery:r}=j(o=>o.globalAppState),n=S(),m=T(),l={manufacturer:"",modelGroup:"",modelDetail:"",bodyStyle:"",damage:"",location:"",odometer:0,cylinders:0,drive:"",engine:0,transmission:"",year:"",keys:"",fuelType:"",color:"",price:0,description:"",photos:null};return e.createElement(N,{pt:["32px",null,null,"40px"]},e.createElement(V,null,e.createElement(P,{w:"500px",bg:"#fff",p:"4"},e.createElement(K,{initialValues:l,onSubmit:(o,{setFieldError:s})=>{const h=o,{photos:c,keys:i}=h,E=k(h,["photos","keys"]),f=new FormData;for(let g in E)f.append(g,o[g]);if(c)for(let g of c)f.append("photo[]",g);i&&f.append("keys",ve.YES);const p=new URLSearchParams(r);n(ye(f)).unwrap().then(()=>{n(be(p)),m({title:"New car edded successfully",position:"top",status:"success",duration:1500})}).catch(g=>{let C="";_(g)&&g.status===422&&(C="Fill in required fields",s("manufacturer","required")),m({title:C,position:"top",variant:"solid",status:"error",duration:2e3})})}},({values:o,setFieldValue:s})=>e.createElement(Q,null,e.createElement(L,null,"Add Car"),e.createElement(d,{name:"manufacturer",placeholder:"Manufacturer"}),e.createElement(d,{name:"modelGroup",placeholder:"Model group"}),e.createElement(d,{name:"modelDetail",placeholder:"Model detail"}),e.createElement(d,{name:"bodyStyle",placeholder:"Body style"}),e.createElement(d,{name:"damage",placeholder:"damage"}),e.createElement(d,{name:"location",placeholder:"location"}),e.createElement(d,{name:"odometer",placeholder:"odometer",type:"number",value:o.odometer||""}),e.createElement(d,{name:"cylinders",placeholder:"cylinders",type:"number",value:o.cylinders||""}),e.createElement(d,{name:"drive",placeholder:"drive"}),e.createElement(d,{name:"engine",type:"number",value:o.engine||"",placeholder:"Engine capacity"}),e.createElement(b,{name:"transmission"},({field:c})=>e.createElement(q,{pt:"2"},e.createElement(De,y(v({},c),{bg:"#EAEAEB",opacity:"0.5",placeholder:"Transmission"}),t.map(i=>e.createElement("option",{key:i,value:i},i))))),e.createElement(d,{name:"year",placeholder:"Year",type:"number",value:o.year||""}),e.createElement(d,{name:"fuelType",placeholder:"Fuel type"}),e.createElement(d,{name:"color",placeholder:"Color"}),e.createElement(d,{name:"price",placeholder:"Price",type:"number",value:o.price||""}),e.createElement(b,{name:"keys"},({field:c})=>e.createElement(q,{pt:"2"},e.createElement(A,null,e.createElement(we,v({colorScheme:"autoOrange",name:"kes"},c)),e.createElement(O,null,"Has keys")))),e.createElement(b,{name:"description"},({field:c})=>e.createElement(Z,y(v({mt:"2"},c),{placeholder:"Write Description",size:"sm",as:J,maxRows:10}))),e.createElement(b,{name:"photos"},({field:c})=>e.createElement("input",y(v({type:"file"},c),{multiple:!0,value:void 0,onChange:i=>{const E=i.currentTarget.files;s("photos",E)}}))),e.createElement(M,{type:"submit",mt:"4",mb:"4",isLoading:a},"Add"))))))},Ve=n=>{var m=n,{onSelect:t,name:a}=m,r=k(m,["onSelect","name"]);const{isOpen:l,onToggle:o,onOpen:s,onClose:c}=xe(),[i,E]=w.exports.useState(),[f,p]=w.exports.useState(""),[h,g]=w.exports.useState(""),[C,X]=w.exports.useState([]),ee=S(),te=T(),ae=()=>{p(i?i.fullName:"Search for user...")},re=u=>{ee(Re(u)).unwrap().then(x=>{X(x)}).catch(()=>te({title:"Could not fetch users",position:"top",status:"error",duration:2e3}))},oe=C.filter(u=>u.fullName.toLocaleLowerCase().includes(h.toLocaleLowerCase()));return e.createElement(Ue,v({areOptionsOpen:l},r),e.createElement(Se,{onClick:c,isActive:l}),e.createElement(Be,null,e.createElement(We,{areOptionsOpen:l,areOptionsSelected:!!i,clearCb:()=>{E(void 0)}},e.createElement(Ie,{autoComplete:"off",bg:"autoGrey.200",name:a||"",label:"Search for user...",placeholder:f,value:i?Pe(i.fullName):h,onChange:u=>{const x=u.currentTarget.value;re(x),g(x),E(void 0),x&&s()},onFocus:()=>{ae()}})),e.createElement(He,{isOpen:l},oe.map(u=>e.createElement(Ce,{h:"80px",onClick:()=>{p(u.fullName),o(),t(u.id),E(u)},key:u.id},e.createElement(A,{w:"full"},e.createElement(W,{ratio:1/1,w:"50px"},e.createElement(I,{w:"full",h:"full",src:u.avatar,fallbackSrc:"https://image.shutterstock.com/image-vector/profile-picture-avatar-icon-vector-260nw-1760295569.jpg",borderRadius:"100px"})),e.createElement(L,null,u.fullName)))))))},_e=({})=>{const t=S(),a=T(),{addingReview:r}=j(o=>o.customers),n={text:"",userId:"",photos:null},m=o=>{let s="";return o?o.length!==24&&(s="Invalid length"):s="Required",s},l=o=>{let s="";return o&&o.length>4&&(s="Photos must be less then 4"),s};return e.createElement(K,{initialValues:n,onSubmit:(o,{setErrors:s})=>{const f=o,{photos:c}=f,i=k(f,["photos"]),E=new FormData;if(c)for(let p of c)E.append("photo[]",p);for(let[p,h]of Object.entries(i))E.append(p,h);t(ke(E)).unwrap().then(()=>{t($("")),a({title:"New Review added",duration:2e3,status:"success",position:"top"})}).catch(p=>{var h;_(p)&&p.status===422&&((h=p.errors)==null?void 0:h.length)&&s(je(p.errors))})}},({setFieldValue:o})=>e.createElement(Q,null,e.createElement(L,{pb:"4"},"Add new Review"),e.createElement(b,{name:"userId",validate:m},({field:s,form:c})=>e.createElement(e.Fragment,null,e.createElement(Ve,y(v({},s),{name:"userId",onSelect:i=>{o("userId",i)}})),e.createElement(O,{as:"span",color:"red"},c.errors.userId))),e.createElement(b,{name:"text"},({field:s})=>e.createElement(Z,y(v({mt:"2"},s),{placeholder:"Write Description",size:"sm",as:J,maxRows:10}))),e.createElement(b,{name:"photos",validate:l},({field:s,form:c})=>e.createElement(e.Fragment,null,e.createElement("input",y(v({},s),{type:"file",multiple:!0,value:void 0,onChange:i=>{o("photos",i.currentTarget.files)}})),e.createElement(O,{as:"span",display:"block",color:"red"},c.errors.photos))),e.createElement(M,{type:"submit",mt:"4",isLoading:r},"Add Review")))},qe=({})=>{const{reviews:t,removingReview:a,fetchingReviews:r}=j(l=>l.customers),n=S(),m=T();return w.exports.useEffect(()=>{n($(""))},[]),e.createElement(N,{pt:["32px",null,null,"40px"]},e.createElement(V,null,e.createElement(Y,{spacing:"32px"},e.createElement(P,{maxW:"500px",p:"4"},e.createElement(_e,null)),e.createElement(P,{w:"full",maxW:"500px"},e.createElement(Y,{w:"full"},r?e.createElement(e.Fragment,null,"Getting Reviews...",e.createElement(Te,null)):t.length?t.map((l,o)=>e.createElement(A,{key:o,bg:"autoGrey.200",w:"full",p:"4",borderRadius:"8",opacity:a?"0.5":"1"},e.createElement(Ae,{icon:e.createElement(Oe,null),"aria-label":"remove review",isLoading:a,onClick:()=>{n(Fe(l.id)).then(()=>m({title:"Review Deleted",status:"success",duration:2e3,position:"top"})).catch(()=>m({title:"Could not delete the review, contact to the developer",status:"error",duration:2e3,position:"top"}))}}),e.createElement(W,{ratio:1/1,minW:"80px"},e.createElement(I,{src:l.user&&l.user.avatar,fallbackSrc:"https://image.shutterstock.com/image-vector/profile-picture-avatar-icon-vector-260nw-1760295569.jpg",borderRadius:"100px"})),e.createElement(O,{overflowWrap:"anywhere"},l.text),l.photos&&l.photos.map(s=>e.createElement(W,{key:s,ratio:1/1,minW:"60px"},e.createElement(I,{src:s}))))):e.createElement(e.Fragment,null,"No Review Yet"))))))},mt=()=>{const{path:t}=ce(),a=S();return console.log(t),e.createElement(N,null,e.createElement(A,{w:"full",justify:"center",pt:"4"},e.createElement(D,{border:"1px solid"},e.createElement(G,{to:`${t}/add-car`},"add new car")),e.createElement(D,{border:"1px solid"},e.createElement(G,{to:`${t}/add-review`},"add new Review")),e.createElement(D,{color:"red",border:"1px solid",onClick:()=>a(Ne())},"logout")),e.createElement(ie,null,e.createElement(F,{path:t,exact:!0},e.createElement(me,{to:`${t}/add-review`})),e.createElement(F,{path:`${t}/add-car`,render:()=>e.createElement(Ge,null),exact:!0}),e.createElement(F,{path:`${t}/add-review`,render:()=>e.createElement(qe,null),exact:!0})))};export{mt as AdminPage,mt as default};
